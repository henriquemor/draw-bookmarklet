javascript:(function(){var a=Math.min;function b(a,d){if(2>=a.length)return a;for(var e,f=0,g=0,h=1;h<a.length-1;h++)e=c(a[h],a[0],a[a.length-1]),e>f&&(f=e,g=h);if(f>d){var j=b(a.slice(0,g+1),d),k=b(a.slice(g),d);return j.slice(0,-1).concat(k)}return[a[0],a[a.length-1]]}function c(b,c,d){var e=Math.sqrt,f=e((d.x-c.x)**2+(d.y-c.y)**2);if(0===f)return e((b.x-c.x)**2+(b.y-c.y)**2);var g=((b.x-c.x)*(d.x-c.x)+(b.y-c.y)*(d.y-c.y))/f**2;g=Math.max(0,a(1,g));var h=c.x+g*(d.x-c.x),i=c.y+g*(d.y-c.y);return e((b.x-h)**2+(b.y-i)**2)}function d(a,b,c,d,e){return(a-b)/(c-b)*(e-d)+d}function f(c){for(var e=b(c,1),f=0;f<e.length-1;f++){var g=0<f?e[f-1]:e[f],h=e[f],j=e[f+1],k=f<e.length-2?e[f+2]:j,l=h.x+(j.x-g.x)/6,m=h.y+(j.y-g.y)/6,p=j.x-(k.x-h.x)/6,q=j.y-(k.y-h.y)/6;if(n.beginPath(),n.moveTo(h.x,h.y),B){var r=(a(g.pressure,h.pressure,j.pressure,k.pressure)+x([g.pressure,h.pressure,j.pressure,k.pressure]))/2*o;n.lineWidth=d(r,0,1,.5*o,3*o*w)}else{var r=o*w;n.lineWidth=r}n.bezierCurveTo(l,m,p,q,j.x,j.y),n.stroke()}}function g(a){if(r){a.preventDefault();var b,c,d;a.changedTouches?(b=a.changedTouches[0].pageX-j.offsetLeft,c=a.changedTouches[0].pageY-j.offsetTop-window.pageYOffset,d=a.changedTouches[0].force||.5):(b=a.pageX-j.offsetLeft,c=a.pageY-j.offsetTop-window.pageYOffset,d="pen"===a.pointerType&&a.pressure?a.pressure:.5),v.push({x:b,y:c,pressure:d}),n.putImageData(s[s.length-1],0,0),f(v)}}function h(a){r=!0,p=a.pageX-j.offsetLeft,q=a.pageY-j.offsetTop-window.pageYOffset,s.push(n.getImageData(0,0,j.width,j.height)),s=s.slice(-20)}function i(a){r=!0,p=a.changedTouches[0].pageX-j.offsetLeft,q=a.changedTouches[0].pageY-j.offsetTop-window.pageYOffset,s.push(n.getImageData(0,0,j.width,j.height)),s=s.slice(-20)}var j=document.getElementById("draw-on-page-canvas");if(j){var k=j.toDataURL();localStorage.setItem("canvasDrawing",k),j.parentNode.removeChild(j);var l=document.getElementById("controls-div");return void l.parentNode.removeChild(l)}j=document.createElement("canvas"),j.id="draw-on-page-canvas",j.style.position="fixed",j.style.top="0",j.style.left="0",j.style.border="2px solid rgba(255, 255, 0, 0.3)";var m=window.devicePixelRatio||2;j.width=(window.innerWidth-20)*m,j.height=window.innerHeight*m,j.style.width=window.innerWidth-20+"px",j.style.height=window.innerHeight+"px",j.style.zIndex="9998";var n=j.getContext("2d");n.scale(m,m),n.strokeStyle="#02498c";var o=1.5;n.lineWidth=o,n.lineCap="round",n.lineJoin="round",document.body.appendChild(j);var p,q,r=!1,s=[];if(localStorage.getItem("canvasDrawing")){var k=localStorage.getItem("canvasDrawing"),t=new Image;t.src=k,n.drawImage(t,0,0)}var u=document.createElement("div");u.id="controls-div",u.style.zIndex="9999",document.body.appendChild(u);var v=[],w=1;const x=a=>a.reduce((c,a)=>c+a)/a.length;j.addEventListener("mousedown",h),j.addEventListener("touchstart",i),j.addEventListener("mousemove",g),j.addEventListener("touchmove",g),j.addEventListener("mouseup",function(){r=!1,v=[]}),j.addEventListener("touchend",function(){r=!1,v=[]}),j.addEventListener("pointermove",function(a){pressure=a.pressure});var y=document.createElement("button");y.textContent="Undo",y.style.position="fixed",y.style.top="105px",y.style.right="20px",y.style.zIndex="9999",u.appendChild(y),y.addEventListener("click",function(){1<s.length?(s.pop(),n.putImageData(s[s.length-1],0,0)):(n.clearRect(0,0,j.width,j.height),s.pop())});var z=!1,A=document.createElement("button");A.textContent="erase",A.style.position="fixed",A.style.top="70px",A.style.right="20px",A.style.zIndex="9999",u.appendChild(A),A.addEventListener("click",function(){z?(A.textContent="erase",n.globalCompositeOperation="source-over",z=!1):(z=!0,A.textContent="erasing (active)",n.globalCompositeOperation="destination-out")});var B=!1,C=document.createElement("button");C.textContent="\uD83D\uDD8C",C.style.position="fixed",C.style.top="140px",C.style.right="20px",C.style.zIndex="9999",u.appendChild(C),C.addEventListener("click",function(){B?(C.textContent="\uD83D\uDD8C",B=!1):(B=!0,C.textContent="\uD83D\uDD8D")});["black","#02498c","#FFAB01","#5bc936","#ef3228","white"].forEach(function(a,b){var c=document.createElement("button");c.style.backgroundColor=a,c.style.width="20px",c.style.height="20px",c.style.borderRadius="5%",c.style.position="fixed",c.style.top="10px",c.style.right=20+22*b+"px",c.style.zIndex="9999",u.appendChild(c),c.addEventListener("click",function(){n.strokeStyle=a,w=1,n.globalCompositeOperation="source-over"})});["rgba(245, 232, 39, 0.1)"].forEach(function(a,b){var c=document.createElement("button");c.style.backgroundColor=a,c.style.width="20px",c.style.height="20px",c.style.borderRadius="5%",c.style.position="fixed",c.style.top="30px",c.style.right=20+22*b+"px",c.style.zIndex="9999",u.appendChild(c),c.addEventListener("click",function(){n.strokeStyle=a,w=20,n.globalCompositeOperation="multiply"})});var D=document.createElement("input");D.type="color",D.value="#02498c",D.style.zIndex="9999",D.style.position="fixed",D.style.top="10px",D.style.right="150px",u.appendChild(D),D.addEventListener("change",function(){n.strokeStyle=D.value});var E=!1,F=document.createElement("button");F.textContent="disable",F.style.position="fixed",F.style.top="250px",F.style.right="20px",F.style.zIndex="9999",u.appendChild(F),F.addEventListener("click",function(){E?(F.textContent="disable",j.style.pointerEvents="auto",E=!1):(E=!0,F.textContent="activate (disabled)",j.style.pointerEvents="none")});var G=document.createElement("button");G.textContent="clear",G.style.position="fixed",G.style.top="220px",G.style.right="20px",G.style.zIndex="9999",u.appendChild(G),G.addEventListener("click",function(){n.clearRect(0,0,j.width,j.height),v=[],s=[]});var H=document.createElement("input");H.type="range",H.min="1",H.max="10",H.value=o,H.style.position="fixed",H.style.top="50px",H.style.right="20px",H.style.zIndex="9999",H.style.width="100px",u.appendChild(H),H.addEventListener("input",function(){o=H.value,n.lineWidth=o,console.log(n.lineWidth)})})();
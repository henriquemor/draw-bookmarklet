javascript:(function(){var a=Math.min;function b(a,d){if(2>=a.length)return a;for(var e,f=0,g=0,h=1;h<a.length-1;h++)e=c(a[h],a[0],a[a.length-1]),e>f&&(f=e,g=h);if(f>d){var j=b(a.slice(0,g+1),d),k=b(a.slice(g),d);return j.slice(0,-1).concat(k)}return[a[0],a[a.length-1]]}function c(b,c,d){var e=Math.sqrt,f=e((d.x-c.x)**2+(d.y-c.y)**2);if(0===f)return e((b.x-c.x)**2+(b.y-c.y)**2);var g=((b.x-c.x)*(d.x-c.x)+(b.y-c.y)*(d.y-c.y))/f**2;g=Math.max(0,a(1,g));var h=c.x+g*(d.x-c.x),i=c.y+g*(d.y-c.y);return e((b.x-h)**2+(b.y-i)**2)}function d(a,b,c,d,e){return(a-b)/(c-b)*(e-d)+d}function f(c){for(var e=b(c,1),f=0;f<e.length-1;f++){var g=0<f?e[f-1]:e[f],h=e[f],j=e[f+1],k=f<e.length-2?e[f+2]:j,l=h.x+(j.x-g.x)/6,o=h.y+(j.y-g.y)/6,p=j.x-(k.x-h.x)/6,q=j.y-(k.y-h.y)/6;if(m.beginPath(),m.moveTo(h.x,h.y),C){var r=(a(g.pressure,h.pressure,j.pressure,k.pressure)+y([g.pressure,h.pressure,j.pressure,k.pressure]))/2*n;m.lineWidth=d(r,0,1,.5*n,3*n*w)}else{var r=n*w;m.lineWidth=r}m.bezierCurveTo(l,o,p,q,j.x,j.y),m.stroke()}}function g(a){if(q){a.preventDefault();var b,c,d;a.changedTouches?(b=a.changedTouches[0].pageX-j.offsetLeft,c=a.changedTouches[0].pageY-j.offsetTop-window.pageYOffset,d=a.changedTouches[0].force||.5):(b=a.pageX-j.offsetLeft,c=a.pageY-j.offsetTop-window.pageYOffset,d="pen"===a.pointerType&&a.pressure?a.pressure:.5),v.push({x:b,y:c,pressure:d}),m.putImageData(r[r.length-1],0,0),f(v)}}function h(a){q=!0,o=a.pageX-j.offsetLeft,p=a.pageY-j.offsetTop-window.pageYOffset,r.push(m.getImageData(0,0,j.width,j.height)),r=r.slice(-20)}function i(a){q=!0,o=a.changedTouches[0].pageX-j.offsetLeft,p=a.changedTouches[0].pageY-j.offsetTop-window.pageYOffset,r.push(m.getImageData(0,0,j.width,j.height)),r=r.slice(-20)}var j=document.getElementById("draw-on-page-canvas");if(j){j.parentNode.removeChild(j);var k=document.getElementById("controls-div");return void k.parentNode.removeChild(k)}j=document.createElement("canvas"),j.id="draw-on-page-canvas",j.style.position="fixed",j.style.top="0",j.style.left="0",j.style.border="2px solid rgba(255, 255, 0, 0.3)";var l=window.devicePixelRatio||2;j.width=(window.innerWidth-20)*l,j.height=window.innerHeight*l,j.style.width=window.innerWidth-20+"px",j.style.height=window.innerHeight+"px",j.style.zIndex="9998";var m=j.getContext("2d");m.scale(l,l),m.strokeStyle="#02498c";var n=1.5;m.lineWidth=n,m.lineCap="round",m.lineJoin="round",document.body.appendChild(j);var o,p,q=!1,r=[];if(localStorage.getItem("canvasDrawing")&&!1){var s=localStorage.getItem("canvasDrawing"),t=new Image;t.src=s,m.drawImage(t,0,0)}var u=document.createElement("div");u.id="controls-div",u.style.zIndex="9999",u.style.fontSize="12px",document.body.appendChild(u);var v=[],w=1,x="";const y=a=>a.reduce((c,a)=>c+a)/a.length;j.addEventListener("mousedown",h),j.addEventListener("touchstart",i),j.addEventListener("mousemove",g),j.addEventListener("touchmove",function(a){E&&"touch"==x?j.style.pointerEvents="none":g(a)}),j.addEventListener("pointerdown",function(a){E&&"touch"==a.pointerType&&(j.style.pointerEvents="none")}),j.addEventListener("mouseup",function(){q=!1,v=[];var a=j.toDataURL();localStorage.setItem("canvasDrawing",a)}),j.addEventListener("touchend",function(){q=!1,v=[];var a=j.toDataURL();localStorage.setItem("canvasDrawing",a),setTimeout(()=>{j.style.pointerEvents="auto"},"1000"),setTimeout(()=>{j.style.pointerEvents="auto"},"4000")}),j.addEventListener("pointermove",function(a){pressure=a.pressure,x=a.pointerType});var z=document.createElement("button");z.textContent="Undo",z.style.position="fixed",z.style.top="105px",z.style.right="20px",z.style.zIndex="9999",u.appendChild(z),z.addEventListener("click",function(){1<r.length?(r.pop(),m.putImageData(r[r.length-1],0,0)):(m.clearRect(0,0,j.width,j.height),r.pop())});var A=!1,B=document.createElement("button");B.textContent="erase",B.style.position="fixed",B.style.top="70px",B.style.right="20px",B.style.zIndex="9999",u.appendChild(B),B.addEventListener("click",function(){A?(B.textContent="erase",m.globalCompositeOperation="source-over",A=!1):(A=!0,B.textContent="erasing (active)",m.globalCompositeOperation="destination-out")});var C=!0,D=document.createElement("button");D.textContent="\uD83D\uDD8D",D.style.position="fixed",D.style.top="140px",D.style.right="20px",D.style.zIndex="9999",u.appendChild(D),D.addEventListener("click",function(){C?(D.textContent="\uD83D\uDD8C",C=!1):(C=!0,D.textContent="\uD83D\uDD8D")});var E=!0,F=document.createElement("button");F.textContent="use hands",F.style.position="fixed",F.style.top="140px",F.style.right="20px",F.style.zIndex="9999",u.appendChild(F),F.addEventListener("click",function(){E?(F.textContent="reject palm",E=!1):(E=!0,F.textContent="use hands")});["black","#02498c","#FFAB01","#5bc936","#ef3228","white"].forEach(function(a,b){var c=document.createElement("button");c.style.backgroundColor=a,c.style.width="20px",c.style.height="20px",c.style.borderRadius="5%",c.style.position="fixed",c.style.top="10px",c.style.right=20+22*b+"px",c.style.zIndex="9999",u.appendChild(c),c.addEventListener("click",function(){m.strokeStyle=a,w=1,m.globalCompositeOperation="source-over"})});["rgba(245, 232, 39, 0.1)"].forEach(function(a,b){var c=document.createElement("button");c.style.backgroundColor=a,c.style.width="20px",c.style.height="20px",c.style.borderRadius="5%",c.style.position="fixed",c.style.top="30px",c.style.right=20+22*b+"px",c.style.zIndex="9999",u.appendChild(c),c.addEventListener("click",function(){m.strokeStyle=a,w=20,m.globalCompositeOperation="multiply"})});var G=document.createElement("input");G.type="color",G.value="#02498c",G.style.zIndex="9999",G.style.position="fixed",G.style.top="10px",G.style.right="150px",u.appendChild(G),G.addEventListener("change",function(){m.strokeStyle=G.value});var H=!1,I=document.createElement("button");I.textContent="disable",I.style.position="fixed",I.style.top="250px",I.style.right="20px",I.style.zIndex="9999",u.appendChild(I),I.addEventListener("click",function(){H?(I.textContent="disable",j.style.pointerEvents="auto",H=!1):(H=!0,I.textContent="activate (disabled)",j.style.pointerEvents="none")});var J=document.createElement("button");J.textContent="clear",J.style.position="fixed",J.style.top="220px",J.style.right="20px",J.style.zIndex="9999",u.appendChild(J),J.addEventListener("click",function(){m.clearRect(0,0,j.width,j.height),v=[],r=[]});var K=document.createElement("input");K.type="range",K.min="1",K.max="10",K.value=n,K.style.position="fixed",K.style.top="50px",K.style.right="20px",K.style.zIndex="9999",K.style.width="100px",u.appendChild(K),K.addEventListener("input",function(){n=K.value,m.lineWidth=n,console.log(m.lineWidth)})})();